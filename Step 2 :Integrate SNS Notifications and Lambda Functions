Steps to be Performed here are as below.

1-Create an SNS topic
2-Create and test the Subscription Lambda function
3-Create and test the Event creation Lambda function

#1 Create an SNS Topic: ------->

SNS (Simple Notification Service) will be used to notify subscribers when a new event is created. Hereâ€™s how to set it up:
Go to the SNS Console
Navigate to the AWS SNS Console.
Go to Create Topic. Click on Next Step.
Select Standard as the topic type.
Provide a name for your topic, such as EventAnnouncements.
Create the Topic
Leave the rest as defaults. Click Create topic. 
Youâ€™ll be directed to the topic details page where you can see the Topic ARN (Amazon Resource Name). This will be used in your Lambda functions to send messages to the topic.
Note: Keep a copy of the Topic ARN for later use.

#2 Create and Test the Subscription Lambda Function: ------->

In this step, we will create the Subscription Lambda function that subscribes users to the SNS topic using their email address.
2a. Create IAM Role for Lambda Function
Before we create the Lambda function, we need to set up an IAM role that gives the Lambda function permissions to interact with AWS SNS (for subscribing users) and log to CloudWatch (for logging Lambda execution).
Steps to Create the IAM Role:
Navigate to IAM Console:
Go to the IAM Console in AWS.
On the left sidebar, select Roles, then click Create role.
Choose a Trusted Entity:
Select AWS service.
For the use case, choose Lambda (this grants Lambda permissions to assume this role).
Attach Permissions Policies:
Search for and select the following policies:
AmazonSNSFullAccess â€“ This grants the Lambda function permission to interact with SNS (subscribe users).
CloudWatchLogsPolicy â€“ This allows logging to CloudWatch for debugging and monitoring.
If you canâ€™t find the CloudWatchLogsPolicy, you can use the predefined AWSLambdaBasicExecutionRole to grant CloudWatch logging permissions.
Review and Create the Role:
Give the role a name, such as LambdaSubscribeRole.
Click Create role to complete the process.

2b. Create the Subscription Lambda Function
Now that we have the necessary IAM role, letâ€™s create the Lambda function.
Navigate to the Lambda Console:
Go to the AWS Lambda Console and click Create function.
Configure the Lambda Function:
Function Name: Enter SubscribeToSNSFunction.
Runtime: Choose Python 3.12
Role: Choose Use an existing role and select the IAM role you just created (LambdaSubscribeRole).
Click on â€˜Create Functionâ€™.
Function Code:
In the code editor, replace the default code with the following code that handles email subscription to SNS:

import json
import boto3
def lambda_handler(event, context):
    # Log the entire event to CloudWatch
    print("Event received:", json.dumps(event))
â€‹
    if 'body' in event:
        body = json.loads(event['body'])
        email = body.get('email', None)
â€‹
        if email:
            sns_client = boto3.client('sns')
â€‹
            try:
                # Subscribe the user to the SNS topic (email subscription)
                response = sns_client.subscribe(
                    TopicArn='enter-sns-topic-ARN',  # Replace with your SNS Topic ARN
                    Protocol='email',
                    Endpoint=email
                )
â€‹
                return {
                    'statusCode': 200,
                    'body': json.dumps({'message': 'Subscription successful! Please check your email to confirm.'})
                }
â€‹
            except Exception as e:
                print(f"Error subscribing user: {str(e)}")
                return {
                    'statusCode': 500,
                    'body': json.dumps({'error': f'Failed to subscribe: {str(e)}'}).encode('utf-8')
                }
â€‹
        else:
            return {
                'statusCode': 400,
                'body': json.dumps({'error': 'Email not provided.'})
            }
â€‹
    return {
        'statusCode': 400,
        'body': json.dumps({'error': 'Invalid request format.'})
    }
â€‹
Explanation of Code:
sns_client = boto3.client('sns'): This creates an SNS client to interact with SNS.
sns_client.subscribe: This subscribes the provided email address to the SNS topic.
The function checks if the email is present in the request body, and if so, subscribes it to the SNS topic using the provided ARN.
ðŸ“Œ NOTE: Replace the â€˜enter-sns-topic-ARNâ€™ with your SNS Topic ARN that we copied in the earlier step. 
Save the Lambda Function:
Click Deploy to save the Lambda function.

2c. Test the Lambda Function
Now weâ€™ll test the Lambda function to ensure that it works correctly. Weâ€™ll simulate an event where a user provides their email for subscription.
Steps to Test the Lambda Function:
Configure a Test Event:
In the Lambda function console, click on Test.
Create a new test event by selecting Create new test event.

Give it a name like TestSubscribeEvent.
Use the following JSON as the test event:
{
  "body": {
    "email": "user@example.com"
  }
}
This simulates a request body containing the email "user@example.com".

Click on Save.
Run the Test:
After configuring the test event, click on Test.
The Lambda function should run, and you should see the log output in the Execution result section.
The response should look like:
{
  "statusCode": 200,
  "body": "{\"message\": \"Subscription successful! Please check your email to confirm.\"}"
}

Verify the Subscription:
Check the email inbox (in this case, "user@example.com") for a confirmation email.
The email should have a confirmation link from AWS SNS.
Once the user confirms the subscription, the email will be successfully subscribed to the SNS topic.

#3 Create and Test Event Creation Lambda Function: ------->

In this step, weâ€™ll set up the Event Creation Lambda Function to update the events.json file in your S3 bucket and send notifications using your SNS topic.
3a. Create an IAM Role for the Lambda Function:
This role grants the necessary permissions for the Lambda function to:
Read and write the events.json file in the S3 bucket.
Publish messages to the SNS topic.
Navigate to IAM console & Create a New Role:
Click Create Role.
Select AWS Service and choose Lambda.
Click Next to proceed.
Attach Policies:
Select AWS managed policies:
- AmazonS3FullAccess (or create a custom policy with restricted S3 access to your bucket).
- AmazonSNSFullAccess (or create a custom policy with access to your SNS topic).
Review and Create:
Name the role, e.g., EventCreationLambdaRole.
Click Create Role.
3b. Create the Event Creation Lambda Function
This function will:
Append new events to the events.json file stored in S3.
Notify subscribers via SNS about the new event.
Navigate to AWS Lambda console & Create the Function:
Click Create Function and choose Author from scratch.
Fill in the details:
Function name: createEventFunction.
Runtime: Python 3.12
Select the IAM role created earlier (EventCreationLambdaRole). Click on Create Function.
Upload the Code:
Copy the following code into the inline editor:

import json
import boto3
from botocore.exceptions import ClientError

s3 = boto3.client('s3')
sns = boto3.client('sns')
â€‹
# S3 and SNS configuration
bucket_name = 'your-bucket-name'
events_file_key = 'events.json'
sns_topic_arn = 'your-sns-topic-arn'
â€‹
def lambda_handler(event, context):
    try:
        new_event = json.loads(event['body'])  # Parse event body
â€‹
        # Fetch existing events
        response = s3.get_object(Bucket=bucket_name, Key=events_file_key)
        events_data = json.loads(response['Body'].read().decode('utf-8'))
â€‹
        # Add the new event
        events_data.append(new_event)
â€‹
        # Update events.json in S3
        s3.put_object(
            Bucket=bucket_name,
            Key=events_file_key,
            Body=json.dumps(events_data, indent=2),
            ContentType='application/json'
        )
â€‹
        # Send SNS notification
        message = f"New Event: {new_event['title']} on {new_event['date']}\n{new_event['description']}"
        sns.publish(TopicArn=sns_topic_arn, Message=message, Subject="New Event Announcement")
â€‹
        return {
            'statusCode': 200,
            'headers': {
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "OPTIONS, POST",
                "Access-Control-Allow-Headers": "Content-Type"
            },
            'body': json.dumps({'message': 'Event created successfully!'})
        }
    
    except ClientError as e:
        print(f"Error: {e}")
        return {
            'statusCode': 500,
            'headers': {
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "OPTIONS, POST",
                "Access-Control-Allow-Headers": "Content-Type"
            },
            'body': json.dumps({'message': 'Error processing the event'})
        }
    
    except Exception as e:
        print(f"Unexpected Error: {e}")
        return {
            'statusCode': 500,
            'headers': {
                "Access-Control-Allow-Origin": "*",
                "Access-Control-Allow-Methods": "OPTIONS, POST",
                "Access-Control-Allow-Headers": "Content-Type"
            },
            'body': json.dumps({'message': 'Unexpected error occurred'})
        }
Update the Configuration:
Replace your-bucket-name with your S3 bucket name.
Replace your-sns-topic-arn with your SNS topic ARN.
Deploy the function.

3c. Test the Event Creation Lambda Function
Verify that the Lambda function can update the events.json file in S3 and send notifications to SNS.
Prepare a Test Event:
Use the following JSON as the test event:
{
    "httpMethod": "POST",
  "body": "{\"title\":\"Tech Meetup\",\"date\":\"2024-12-01\",\"description\":\"A gathering of tech enthusiasts!\"}"
}
Run the Test:
Click Test and paste the JSON above.

Name the test, e.g., TestEventCreation.
Click on Save and test the new test event.

Verify the Output:
Expected response:
{
  "statusCode": 200,
  "body": "{\"message\": \"Event created successfully!\"}"
}

Confirm that:
- The events.json file in S3 was updated with the new event. (You can download the events.json and check if you are curious or check the last modified time for events.json to make sure there was an update)
- Subscribers received an email notification about the new event.
